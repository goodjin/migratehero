# MigrateHero æ•°æ®è¿ç§»å¹³å° - äº§å“è®¾è®¡æ–¹æ¡ˆ

> ä¼ä¸šçº§é‚®ä»¶ã€æ—¥å†ã€è”ç³»äººè¿ç§»è§£å†³æ–¹æ¡ˆ

## ä¸€ã€äº§å“æ¦‚è¿°

### 1.1 äº§å“å®šä½

**MigrateHero** æ˜¯ä¸€æ¬¾ä¼ä¸šçº§æ•°æ®è¿ç§»è§£å†³æ–¹æ¡ˆï¼Œä¸“æ³¨äºå¸®åŠ©ä¼ä¸šåœ¨ä¸åŒé‚®ä»¶å¹³å°ä¹‹é—´æ— ç¼è¿ç§»**é‚®ä»¶ã€æ—¥å†ã€è”ç³»äºº**æ•°æ®ï¼Œå®ç°**é›¶åœæœº**çš„é‚®ä»¶ç³»ç»Ÿåˆ‡æ¢ã€‚

### 1.2 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

| ä»·å€¼ç‚¹ | æè¿° |
|-------|------|
| **Seamless Migration** | æ— ç¼è¿ç§»ä½“éªŒ |
| **Zero Downtime** | é›¶åœæœºï¼Œç”¨æˆ·å¯æŒç»­è®¿é—®é‚®ä»¶ |
| **80% Faster** | æ¯”ä¼ ç»Ÿæ–¹æ³•å¿« 80% |
| **50% Cost Reduction** | é™ä½ 50% è¿ç§»æˆæœ¬ |

### 1.3 Slogan

> "Seamless Migration. Zero Downtime."

### 1.4 ç›®æ ‡ç”¨æˆ·

| ç”¨æˆ·ç±»å‹ | éœ€æ±‚åœºæ™¯ |
|---------|---------|
| **IT ç®¡ç†å‘˜** | ä¼ä¸šé‚®ä»¶ç³»ç»Ÿè¿ç§»è§„åˆ’ä¸æ‰§è¡Œ |
| **ä¼ä¸šå†³ç­–è€…** | è¯„ä¼°é‚®ä»¶å¹³å°åˆ‡æ¢æ–¹æ¡ˆ |
| **ä¸­å°ä¼ä¸š** | ä»ä¸€ä¸ªé‚®ä»¶æœåŠ¡åˆ‡æ¢åˆ°å¦ä¸€ä¸ª |
| **å¤§å‹ä¼ä¸š** | å¤§è§„æ¨¡é‚®ä»¶æ•°æ®è¿ç§» |

---

## äºŒã€äº§å“åŠŸèƒ½

### 2.1 æ”¯æŒçš„è¿ç§»å†…å®¹

| ç±»å‹ | çŠ¶æ€ | æè¿° |
|-----|------|------|
| **Emails** | âœ… å·²å®ç° | é‚®ä»¶å†…å®¹ã€é™„ä»¶ã€æ–‡ä»¶å¤¹ç»“æ„ |
| **Contacts** | ğŸ”„ å¼€å‘ä¸­ | è”ç³»äººä¿¡æ¯ã€é€šè®¯å½• |
| **Calendars** | ğŸ”„ å¼€å‘ä¸­ | æ—¥å†äº‹ä»¶ã€ä¼šè®®å®‰æ’ |
| **Drive Files** | ğŸ”œ è§„åˆ’ä¸­ | äº‘ç›˜æ–‡ä»¶è¿ç§» |

### 2.2 æ”¯æŒçš„å¹³å°ï¼ˆMVPï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å½“å‰ MVP æ”¯æŒ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â”‚  Exchange       â”‚   â”€â”€â†’   â”‚  IMAP é‚®ç®±      â”‚          â”‚
â”‚   â”‚  (EWS åè®®)     â”‚         â”‚  (ç½‘æ˜“ã€è…¾è®¯ç­‰)  â”‚          â”‚
â”‚   â”‚                 â”‚         â”‚                 â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                              â”‚
â”‚   æºç«¯: Exchange Web Services (EWS)                         â”‚
â”‚   ç›®æ ‡ç«¯: IMAP åè®®                                          â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### æ¨¡å—ä¸€ï¼šè¿ç§»ä»»åŠ¡ç®¡ç†

**çŠ¶æ€æµè½¬**ï¼š
```
DRAFT (è‰ç¨¿) â†’ RUNNING (è¿è¡Œä¸­) â†’ COMPLETED (å®Œæˆ)
                    â†“
               PAUSED (æš‚åœ) â†’ RUNNING (ç»§ç»­)
                    â†“
               FAILED (å¤±è´¥) â†’ RUNNING (é‡è¯•)
```

**åŠŸèƒ½**ï¼š
- åˆ›å»ºè¿ç§»ä»»åŠ¡ï¼ˆé…ç½®æºç«¯ EWS å’Œç›®æ ‡ç«¯ IMAPï¼‰
- æµ‹è¯•è¿æ¥éªŒè¯
- å¯åŠ¨/æš‚åœ/é‡è¯•è¿ç§»
- åˆ é™¤ä»»åŠ¡ï¼ˆä»…é™è‰ç¨¿ã€æš‚åœã€å¤±è´¥çŠ¶æ€ï¼‰

#### æ¨¡å—äºŒï¼šå®æ—¶è¿›åº¦ç›‘æ§

**åŠŸèƒ½**ï¼š
- å®æ—¶è¿ç§»è¿›åº¦æ˜¾ç¤ºï¼ˆWebSocket æ¨é€ï¼‰
- æ–‡ä»¶å¤¹çº§åˆ«è¿›åº¦è·Ÿè¸ª
- é‚®ä»¶çº§åˆ«è¿ç§»è®°å½•
- é”™è¯¯æ—¥å¿—æŸ¥çœ‹

**ç•Œé¢æ•°æ®**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Migration Progress                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  æ•´ä½“è¿›åº¦                  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  88%       â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ–‡ä»¶å¤¹          æ€»æ•°    å·²è¿ç§»   å¤±è´¥    çŠ¶æ€          â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ æ”¶ä»¶ç®±          150     148      2      âœ… å®Œæˆ       â”‚  â”‚
â”‚  â”‚ å·²å‘é€é‚®ä»¶       80      80      0      âœ… å®Œæˆ       â”‚  â”‚
â”‚  â”‚ å·²åˆ é™¤é‚®ä»¶       24       5     19      âœ… å®Œæˆ       â”‚  â”‚
â”‚  â”‚ è‰ç¨¿             10      10      0      âœ… å®Œæˆ       â”‚  â”‚
â”‚  â”‚ æ—¥å†              0       -      -      â­ï¸ è·³è¿‡       â”‚  â”‚
â”‚  â”‚ è”ç³»äºº            0       -      -      â­ï¸ è·³è¿‡       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  å½“å‰æ–‡ä»¶å¤¹: å·²åˆ é™¤é‚®ä»¶                                       â”‚
â”‚  çŠ¶æ€: è¿è¡Œä¸­                                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ¨¡å—ä¸‰ï¼šæ–­ç‚¹ç»­ä¼ 

**ç‰¹ç‚¹**ï¼š
- ä»»åŠ¡æš‚åœåå¯ä»æ–­ç‚¹ç»§ç»­
- å¤±è´¥ä»»åŠ¡é‡è¯•æ—¶è·³è¿‡å·²æˆåŠŸè¿ç§»çš„é‚®ä»¶
- æ¯å°é‚®ä»¶ç‹¬ç«‹è®°å½•è¿ç§»çŠ¶æ€

---

## ä¸‰ã€æ•°æ®æ¨¡å‹

### 3.1 æ ¸å¿ƒå®ä½“å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MvpMigrationTask   â”‚  è¿ç§»ä»»åŠ¡ä¸»è¡¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                 â”‚
â”‚  sourceEwsUrl       â”‚  æº EWS åœ°å€
â”‚  sourceEmail        â”‚  æºé‚®ç®±
â”‚  sourcePassword     â”‚  æºå¯†ç ï¼ˆåŠ å¯†ï¼‰
â”‚  targetImapHost     â”‚  ç›®æ ‡ IMAP ä¸»æœº
â”‚  targetImapPort     â”‚  ç›®æ ‡ç«¯å£
â”‚  targetImapSsl      â”‚  æ˜¯å¦ SSL
â”‚  targetEmail        â”‚  ç›®æ ‡é‚®ç®±
â”‚  targetPassword     â”‚  ç›®æ ‡å¯†ç ï¼ˆåŠ å¯†ï¼‰
â”‚  status             â”‚  çŠ¶æ€
â”‚  progressPercent    â”‚  è¿›åº¦ç™¾åˆ†æ¯”
â”‚  totalFolders       â”‚  æ€»æ–‡ä»¶å¤¹æ•°
â”‚  migratedFolders    â”‚  å·²è¿ç§»æ–‡ä»¶å¤¹æ•°
â”‚  totalEmails        â”‚  æ€»é‚®ä»¶æ•°
â”‚  migratedEmails     â”‚  å·²è¿ç§»é‚®ä»¶æ•°
â”‚  failedEmails       â”‚  å¤±è´¥é‚®ä»¶æ•°
â”‚  currentFolder      â”‚  å½“å‰å¤„ç†æ–‡ä»¶å¤¹
â”‚  errorMessage       â”‚  é”™è¯¯ä¿¡æ¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MvpFolderProgress  â”‚  æ–‡ä»¶å¤¹è¿›åº¦è¡¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                 â”‚
â”‚  taskId             â”‚  å…³è”ä»»åŠ¡
â”‚  folderName         â”‚  æ–‡ä»¶å¤¹åç§°
â”‚  folderPath         â”‚  æ–‡ä»¶å¤¹è·¯å¾„
â”‚  displayName        â”‚  æ˜¾ç¤ºåç§°
â”‚  totalEmails        â”‚  æ€»é‚®ä»¶æ•°
â”‚  migratedEmails     â”‚  å·²è¿ç§»æ•°
â”‚  failedEmails       â”‚  å¤±è´¥æ•°
â”‚  status             â”‚  pending/in_progress/completed/failed
â”‚  startedAt          â”‚  å¼€å§‹æ—¶é—´
â”‚  completedAt        â”‚  å®Œæˆæ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MvpMigratedEmail   â”‚  å·²è¿ç§»é‚®ä»¶è®°å½•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                 â”‚
â”‚  taskId             â”‚  å…³è”ä»»åŠ¡
â”‚  sourceEmailId      â”‚  æºé‚®ä»¶ID
â”‚  folderName         â”‚  æ‰€å±æ–‡ä»¶å¤¹
â”‚  subject            â”‚  ä¸»é¢˜
â”‚  fromAddress        â”‚  å‘ä»¶äºº
â”‚  sentDate           â”‚  å‘é€æ—¶é—´
â”‚  sizeBytes          â”‚  å¤§å°
â”‚  success            â”‚  æ˜¯å¦æˆåŠŸ
â”‚  errorMessage       â”‚  å¤±è´¥åŸå› 
â”‚  targetEmailId      â”‚  ç›®æ ‡é‚®ä»¶ID
â”‚  migratedAt         â”‚  è¿ç§»æ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 æ—¥å†äº‹ä»¶è¿ç§»è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MvpMigratedCalendarEvent  â”‚  å·²è¿ç§»æ—¥å†äº‹ä»¶è®°å½•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                        â”‚  ä¸»é”®
â”‚  taskId                    â”‚  å…³è”ä»»åŠ¡
â”‚  sourceEventId             â”‚  æºäº‹ä»¶ID
â”‚  calendarName              â”‚  æ—¥å†åç§°
â”‚  subject                   â”‚  äº‹ä»¶ä¸»é¢˜
â”‚  location                  â”‚  åœ°ç‚¹
â”‚  startTime                 â”‚  å¼€å§‹æ—¶é—´
â”‚  endTime                   â”‚  ç»“æŸæ—¶é—´
â”‚  isAllDay                  â”‚  æ˜¯å¦å…¨å¤©äº‹ä»¶
â”‚  isRecurring               â”‚  æ˜¯å¦é‡å¤äº‹ä»¶
â”‚  organizer                 â”‚  ç»„ç»‡è€…
â”‚  attendees                 â”‚  å‚ä¸è€…ï¼ˆJSONï¼‰
â”‚  success                   â”‚  æ˜¯å¦æˆåŠŸ
â”‚  errorMessage              â”‚  å¤±è´¥åŸå› 
â”‚  targetEventId             â”‚  ç›®æ ‡äº‹ä»¶ID
â”‚  migratedAt                â”‚  è¿ç§»æ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ—¥å†äº‹ä»¶å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `sourceEventId` | String | EWS è¿”å›çš„å”¯ä¸€äº‹ä»¶æ ‡è¯† |
| `calendarName` | String | æ—¥å†åç§°ï¼ˆé»˜è®¤æ—¥å†ã€å·¥ä½œæ—¥å†ç­‰ï¼‰ |
| `subject` | String | ä¼šè®®/äº‹ä»¶ä¸»é¢˜ |
| `location` | String | ä¼šè®®åœ°ç‚¹æˆ–ä¼šè®®é“¾æ¥ |
| `startTime` | Instant | äº‹ä»¶å¼€å§‹æ—¶é—´ï¼ˆUTCï¼‰ |
| `endTime` | Instant | äº‹ä»¶ç»“æŸæ—¶é—´ï¼ˆUTCï¼‰ |
| `isAllDay` | Boolean | å…¨å¤©äº‹ä»¶æ ‡è¯† |
| `isRecurring` | Boolean | æ˜¯å¦ä¸ºé‡å¤äº‹ä»¶ï¼ˆå‘¨ä¼šç­‰ï¼‰ |
| `organizer` | String | ä¼šè®®ç»„ç»‡è€…é‚®ç®± |
| `attendees` | String(JSON) | å‚ä¸è€…åˆ—è¡¨ï¼Œæ ¼å¼ï¼š`[{"email":"...", "status":"accepted"}]` |

### 3.3 è”ç³»äººè¿ç§»è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MvpMigratedContact     â”‚  å·²è¿ç§»è”ç³»äººè®°å½•
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                     â”‚  ä¸»é”®
â”‚  taskId                 â”‚  å…³è”ä»»åŠ¡
â”‚  sourceContactId        â”‚  æºè”ç³»äººID
â”‚  folderName             â”‚  è”ç³»äººæ–‡ä»¶å¤¹
â”‚  displayName            â”‚  æ˜¾ç¤ºåç§°
â”‚  firstName              â”‚  å
â”‚  lastName               â”‚  å§“
â”‚  company                â”‚  å…¬å¸
â”‚  jobTitle               â”‚  èŒä½
â”‚  emailAddresses         â”‚  é‚®ç®±åœ°å€ï¼ˆJSONï¼‰
â”‚  phoneNumbers           â”‚  ç”µè¯å·ç ï¼ˆJSONï¼‰
â”‚  businessAddress        â”‚  å·¥ä½œåœ°å€
â”‚  homeAddress            â”‚  å®¶åº­åœ°å€
â”‚  notes                  â”‚  å¤‡æ³¨
â”‚  success                â”‚  æ˜¯å¦æˆåŠŸ
â”‚  errorMessage           â”‚  å¤±è´¥åŸå› 
â”‚  targetContactId        â”‚  ç›®æ ‡è”ç³»äººID
â”‚  migratedAt             â”‚  è¿ç§»æ—¶é—´
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è”ç³»äººå­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| `sourceContactId` | String | EWS è¿”å›çš„å”¯ä¸€è”ç³»äººæ ‡è¯† |
| `folderName` | String | è”ç³»äººæ–‡ä»¶å¤¹ï¼ˆé»˜è®¤è”ç³»äººã€å®¢æˆ·ç­‰ï¼‰ |
| `displayName` | String | å®Œæ•´æ˜¾ç¤ºåç§° |
| `firstName` / `lastName` | String | å/å§“ |
| `company` / `jobTitle` | String | å…¬å¸/èŒä½ |
| `emailAddresses` | String(JSON) | é‚®ç®±åˆ—è¡¨ï¼š`[{"type":"work", "email":"..."}]` |
| `phoneNumbers` | String(JSON) | ç”µè¯åˆ—è¡¨ï¼š`[{"type":"mobile", "number":"..."}]` |
| `businessAddress` | String | å·¥ä½œåœ°å€ï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼‰ |
| `homeAddress` | String | å®¶åº­åœ°å€ï¼ˆæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼‰ |
| `notes` | String | å¤‡æ³¨ä¿¡æ¯ |

---

## å››ã€æŠ€æœ¯æ¶æ„

### 4.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MigrateHero Platform                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              å‰ç«¯å±‚ (React + TypeScript)             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚  â”‚ ä»»åŠ¡åˆ—è¡¨ â”‚  â”‚ åˆ›å»ºå‘å¯¼ â”‚  â”‚ è¿›åº¦è¯¦æƒ… â”‚             â”‚    â”‚
â”‚  â”‚  â”‚MvpHome  â”‚  â”‚TaskModalâ”‚  â”‚TaskDetailâ”‚             â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              API å±‚ (Spring Boot)                    â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  MvpMigrationController                              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ POST /tasks          åˆ›å»ºä»»åŠ¡                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /tasks          è·å–ä»»åŠ¡åˆ—è¡¨               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /tasks/{id}     è·å–ä»»åŠ¡è¯¦æƒ…               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ POST /tasks/{id}/start   å¯åŠ¨è¿ç§»              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ POST /tasks/{id}/pause   æš‚åœè¿ç§»              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ POST /tasks/{id}/retry   é‡è¯•è¿ç§»              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ DELETE /tasks/{id}       åˆ é™¤ä»»åŠ¡              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ GET  /tasks/{id}/folders è·å–æ–‡ä»¶å¤¹è¿›åº¦        â”‚    â”‚
â”‚  â”‚  â””â”€â”€ POST /test-connection    æµ‹è¯•è¿æ¥              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              æœåŠ¡å±‚ (Business Logic)                 â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  MvpMigrationService                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ createTask()        åˆ›å»ºä»»åŠ¡                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ startMigration()    å¼‚æ­¥æ‰§è¡Œè¿ç§»                â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ migrateFolder()     è¿ç§»å•ä¸ªæ–‡ä»¶å¤¹              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ pauseTask()         æš‚åœä»»åŠ¡                    â”‚    â”‚
â”‚  â”‚  â””â”€â”€ broadcastProgress() WebSocketæ¨é€è¿›åº¦           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   è¿æ¥å™¨å±‚                           â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚    â”‚
â”‚  â”‚  â”‚  MvpEwsConnector â”‚  â”‚   ImapConnector  â”‚        â”‚    â”‚
â”‚  â”‚  â”‚  (æºç«¯è¯»å–)       â”‚  â”‚   (ç›®æ ‡ç«¯å†™å…¥)    â”‚        â”‚    â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚        â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ listFolders() â”‚  â”‚  â€¢ uploadEmail() â”‚        â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ listEmails()  â”‚  â”‚  â€¢ testConnect() â”‚        â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ getMimeContentâ”‚  â”‚                  â”‚        â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 é‚®ä»¶è¿ç§»æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é‚®ä»¶è¿ç§»æ‰§è¡Œæµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. è·å–æ–‡ä»¶å¤¹åˆ—è¡¨                                           â”‚
â”‚     ewsConnector.listFolders()                              â”‚
â”‚     â””â”€â”€ è¿”å›æ‰€æœ‰æ–‡ä»¶å¤¹åŠé‚®ä»¶æ•°é‡                              â”‚
â”‚                                                              â”‚
â”‚  2. åˆ›å»ºæ–‡ä»¶å¤¹è¿›åº¦è®°å½•                                        â”‚
â”‚     ä¸ºæ¯ä¸ªæ–‡ä»¶å¤¹åˆ›å»º MvpFolderProgress                       â”‚
â”‚                                                              â”‚
â”‚  3. é€æ–‡ä»¶å¤¹è¿ç§»                                             â”‚
â”‚     for each folder:                                         â”‚
â”‚       â”œâ”€â”€ è·³è¿‡ç©ºæ–‡ä»¶å¤¹ï¼ˆæ—¥å†ã€è”ç³»äººç­‰ï¼‰                       â”‚
â”‚       â”œâ”€â”€ åˆ†æ‰¹è·å–é‚®ä»¶ (BATCH_SIZE=10)                       â”‚
â”‚       â”‚   ewsConnector.listEmails(offset, limit)            â”‚
â”‚       â”œâ”€â”€ è·å– MIME å†…å®¹                                     â”‚
â”‚       â”‚   ewsConnector.getEmailsMimeContent(emailIds)       â”‚
â”‚       â”œâ”€â”€ æ£€æŸ¥æ˜¯å¦å·²è¿ç§»ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰                          â”‚
â”‚       â”‚   migratedEmailRepository.existsByTaskIdAndSourceEmailIdAndSuccess()  â”‚
â”‚       â”œâ”€â”€ ä¸Šä¼ åˆ°ç›®æ ‡                                         â”‚
â”‚       â”‚   imapConnector.uploadEmail(folder, mimeContent)    â”‚
â”‚       â”œâ”€â”€ è®°å½•è¿ç§»ç»“æœ                                       â”‚
â”‚       â”‚   migratedEmailRepository.save(record)              â”‚
â”‚       â””â”€â”€ å¹¿æ’­è¿›åº¦                                           â”‚
â”‚           messagingTemplate.convertAndSend()                â”‚
â”‚                                                              â”‚
â”‚  4. æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸º COMPLETED                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 æ–‡ä»¶å¤¹åç§°æ˜ å°„

å½“å‰æ”¯æŒçš„ EWS â†’ IMAP æ–‡ä»¶å¤¹æ˜ å°„ï¼š

| EWS æ–‡ä»¶å¤¹å | IMAP æ–‡ä»¶å¤¹å |
|-------------|--------------|
| inbox / æ”¶ä»¶ç®± | INBOX |
| sent items / å·²å‘é€é‚®ä»¶ | Sent |
| drafts / è‰ç¨¿ | Drafts |
| deleted items / å·²åˆ é™¤é‚®ä»¶ | Trash |
| junk email / åƒåœ¾é‚®ä»¶ | Junk |
| archive / å­˜æ¡£ | Archive |
| å…¶ä»–è‡ªå®šä¹‰æ–‡ä»¶å¤¹ | ä¿æŒåŸå |

---

## äº”ã€æ—¥å†è¿ç§»è®¾è®¡

### 5.1 EWS æ—¥å†æ•°æ®è·å–

**éœ€è¦å®ç°çš„ EWS API è°ƒç”¨**ï¼š

```java
public interface EwsCalendarConnector {

    /**
     * è·å–æ—¥å†åˆ—è¡¨
     */
    List<CalendarInfo> listCalendars(String ewsUrl, String email, String password);

    /**
     * è·å–æ—¥å†äº‹ä»¶åˆ—è¡¨
     * @param calendarId æ—¥å†ID
     * @param startDate å¼€å§‹æ—¥æœŸï¼ˆè·å–æ­¤æ—¥æœŸåçš„äº‹ä»¶ï¼‰
     * @param endDate ç»“æŸæ—¥æœŸ
     */
    List<CalendarEventInfo> listEvents(String ewsUrl, String email, String password,
                                        String calendarId, Instant startDate, Instant endDate);

    /**
     * è·å–äº‹ä»¶è¯¦æƒ…ï¼ˆåŒ…å«å®Œæ•´ä¿¡æ¯ï¼‰
     */
    CalendarEventDetail getEventDetail(String ewsUrl, String email, String password,
                                        String eventId);
}
```

**EWS æ—¥å†äº‹ä»¶æ•°æ®ç»“æ„**ï¼š

```java
@Data
public class CalendarEventInfo {
    String id;              // EWS ItemId
    String subject;         // ä¸»é¢˜
    Instant start;          // å¼€å§‹æ—¶é—´
    Instant end;            // ç»“æŸæ—¶é—´
    boolean isAllDay;       // å…¨å¤©äº‹ä»¶
    String location;        // åœ°ç‚¹
    String organizer;       // ç»„ç»‡è€…
}

@Data
public class CalendarEventDetail extends CalendarEventInfo {
    String body;            // äº‹ä»¶æè¿°ï¼ˆHTMLï¼‰
    boolean isRecurring;    // æ˜¯å¦é‡å¤
    String recurrencePattern; // é‡å¤è§„åˆ™ï¼ˆiCal RRULEæ ¼å¼ï¼‰
    List<Attendee> attendees; // å‚ä¸è€…åˆ—è¡¨
    List<String> categories;  // åˆ†ç±»æ ‡ç­¾
    int reminderMinutes;    // æé†’æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    String sensitivity;     // æ•æ„Ÿåº¦ï¼ˆNormal/Private/Confidentialï¼‰
    String showAs;          // å¿™/é—²çŠ¶æ€ï¼ˆFree/Busy/Tentative/OOFï¼‰
}

@Data
public class Attendee {
    String email;
    String name;
    String status;  // Accepted/Declined/Tentative/None
    String type;    // Required/Optional/Resource
}
```

### 5.2 ç›®æ ‡ç«¯æ—¥å†å†™å…¥

**CalDAV åè®®æˆ– IMAP ç‰¹æ®Šæ–‡ä»¶å¤¹**ï¼š

å¯¹äºæ”¯æŒ CalDAV çš„ç›®æ ‡ç³»ç»Ÿï¼ˆå¦‚ç½‘æ˜“é‚®ç®±ã€è…¾è®¯ä¼ä¸šé‚®ç®±ï¼‰ï¼š

```java
public interface CalDavConnector {

    /**
     * åˆ›å»ºæ—¥å†äº‹ä»¶
     * @param iCalData iCalendar æ ¼å¼æ•°æ®
     */
    String createEvent(String calDavUrl, String email, String password,
                       String calendarPath, String iCalData);

    /**
     * æ›´æ–°æ—¥å†äº‹ä»¶
     */
    void updateEvent(String calDavUrl, String email, String password,
                     String eventPath, String iCalData);
}
```

**iCalendar æ ¼å¼ç¤ºä¾‹**ï¼š

```
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//MigrateHero//Calendar Migration//EN
BEGIN:VEVENT
UID:event-12345@migratehero.com
DTSTART:20241225T090000Z
DTEND:20241225T100000Z
SUMMARY:å¹´ç»ˆæ€»ç»“ä¼šè®®
LOCATION:ä¼šè®®å®¤A
DESCRIPTION:2024å¹´åº¦å·¥ä½œæ€»ç»“
ORGANIZER:mailto:boss@company.com
ATTENDEE;PARTSTAT=ACCEPTED:mailto:user1@company.com
ATTENDEE;PARTSTAT=TENTATIVE:mailto:user2@company.com
RRULE:FREQ=WEEKLY;BYDAY=MO
END:VEVENT
END:VCALENDAR
```

### 5.3 æ—¥å†è¿ç§»æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ—¥å†è¿ç§»æ‰§è¡Œæµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. è·å–æºç«¯æ—¥å†åˆ—è¡¨                                         â”‚
â”‚     ewsCalendarConnector.listCalendars()                    â”‚
â”‚                                                              â”‚
â”‚  2. è·å–æ—¥å†äº‹ä»¶                                             â”‚
â”‚     for each calendar:                                       â”‚
â”‚       â””â”€â”€ ewsCalendarConnector.listEvents(startDate, endDate)â”‚
â”‚                                                              â”‚
â”‚  3. è½¬æ¢ä¸º iCalendar æ ¼å¼                                    â”‚
â”‚     for each event:                                          â”‚
â”‚       â”œâ”€â”€ æ£€æŸ¥æ˜¯å¦å·²è¿ç§»ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰                          â”‚
â”‚       â”œâ”€â”€ è·å–äº‹ä»¶è¯¦æƒ…                                       â”‚
â”‚       â”‚   ewsCalendarConnector.getEventDetail(eventId)      â”‚
â”‚       â”œâ”€â”€ è½¬æ¢ä¸º iCalendar æ ¼å¼                              â”‚
â”‚       â”‚   CalendarTransformer.toICalendar(eventDetail)      â”‚
â”‚       â””â”€â”€ å¤„ç†é‡å¤äº‹ä»¶è§„åˆ™                                   â”‚
â”‚                                                              â”‚
â”‚  4. å†™å…¥ç›®æ ‡ç«¯                                               â”‚
â”‚     calDavConnector.createEvent(iCalData)                   â”‚
â”‚                                                              â”‚
â”‚  5. è®°å½•è¿ç§»ç»“æœ                                             â”‚
â”‚     migratedCalendarEventRepository.save(record)            â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.4 æ—¥å†è¿ç§»æ³¨æ„äº‹é¡¹

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|-----|---------|
| **æ—¶åŒºå¤„ç†** | ç»Ÿä¸€è½¬æ¢ä¸º UTC å­˜å‚¨ï¼Œå†™å…¥æ—¶æ ¹æ®ç›®æ ‡ç³»ç»Ÿæ—¶åŒºè½¬æ¢ |
| **é‡å¤äº‹ä»¶** | ä¿ç•™åŸå§‹ RRULE è§„åˆ™ï¼Œç¡®ä¿å‘¨æœŸæ€§ä¼šè®®æ­£ç¡®è¿ç§» |
| **ä¼šè®®å“åº”çŠ¶æ€** | ä¿ç•™å‚ä¸è€…çš„æ¥å—/æ‹’ç»çŠ¶æ€ |
| **ç§æœ‰äº‹ä»¶** | ä¿ç•™ Sensitivity å±æ€§ |
| **é™„ä»¶** | æš‚ä¸æ”¯æŒï¼Œåç»­ç‰ˆæœ¬å¢åŠ  |

---

## å…­ã€è”ç³»äººè¿ç§»è®¾è®¡

### 6.1 EWS è”ç³»äººæ•°æ®è·å–

**éœ€è¦å®ç°çš„ EWS API è°ƒç”¨**ï¼š

```java
public interface EwsContactConnector {

    /**
     * è·å–è”ç³»äººæ–‡ä»¶å¤¹åˆ—è¡¨
     */
    List<ContactFolderInfo> listContactFolders(String ewsUrl, String email, String password);

    /**
     * è·å–è”ç³»äººåˆ—è¡¨
     * @param folderId è”ç³»äººæ–‡ä»¶å¤¹ID
     * @param offset åç§»é‡
     * @param limit æ•°é‡é™åˆ¶
     */
    ContactListResult listContacts(String ewsUrl, String email, String password,
                                    String folderId, int offset, int limit);

    /**
     * è·å–è”ç³»äººè¯¦æƒ…
     */
    ContactDetail getContactDetail(String ewsUrl, String email, String password,
                                    String contactId);
}
```

**EWS è”ç³»äººæ•°æ®ç»“æ„**ï¼š

```java
@Data
public class ContactInfo {
    String id;              // EWS ItemId
    String displayName;     // æ˜¾ç¤ºåç§°
    String firstName;       // å
    String lastName;        // å§“
    String company;         // å…¬å¸
}

@Data
public class ContactDetail extends ContactInfo {
    String middleName;              // ä¸­é—´å
    String nickName;                // æ˜µç§°
    String jobTitle;                // èŒä½
    String department;              // éƒ¨é—¨
    String manager;                 // ä¸Šçº§
    String assistantName;           // åŠ©ç†
    String spouseName;              // é…å¶
    Instant birthday;               // ç”Ÿæ—¥
    Instant anniversary;            // çºªå¿µæ—¥

    List<EmailAddress> emailAddresses;    // é‚®ç®±åˆ—è¡¨
    List<PhoneNumber> phoneNumbers;       // ç”µè¯åˆ—è¡¨
    List<Address> addresses;              // åœ°å€åˆ—è¡¨
    List<String> imAddresses;             // IM åœ°å€

    String businessHomePage;        // å…¬å¸ç½‘ç«™
    String personalHomePage;        // ä¸ªäººç½‘ç«™
    String notes;                   // å¤‡æ³¨
    byte[] photo;                   // å¤´åƒï¼ˆå¯é€‰ï¼‰
}

@Data
public class EmailAddress {
    String type;    // Email1/Email2/Email3
    String email;
    String label;   // è‡ªå®šä¹‰æ ‡ç­¾
}

@Data
public class PhoneNumber {
    String type;    // BusinessPhone/HomePhone/MobilePhone/...
    String number;
}

@Data
public class Address {
    String type;    // Business/Home/Other
    String street;
    String city;
    String state;
    String postalCode;
    String country;
}
```

### 6.2 ç›®æ ‡ç«¯è”ç³»äººå†™å…¥

**CardDAV åè®®**ï¼š

```java
public interface CardDavConnector {

    /**
     * åˆ›å»ºè”ç³»äºº
     * @param vCardData vCard æ ¼å¼æ•°æ®
     */
    String createContact(String cardDavUrl, String email, String password,
                         String addressBookPath, String vCardData);

    /**
     * è·å–é€šè®¯å½•è·¯å¾„
     */
    String getAddressBookPath(String cardDavUrl, String email, String password);
}
```

**vCard æ ¼å¼ç¤ºä¾‹**ï¼š

```
BEGIN:VCARD
VERSION:3.0
N:å¼ ;ä¸‰;;;
FN:å¼ ä¸‰
ORG:ç§‘æŠ€å…¬å¸
TITLE:é«˜çº§å·¥ç¨‹å¸ˆ
TEL;TYPE=WORK:+86-10-12345678
TEL;TYPE=CELL:+86-138-0000-0000
EMAIL;TYPE=WORK:zhangsan@company.com
EMAIL;TYPE=HOME:zhangsan@personal.com
ADR;TYPE=WORK:;;æœé˜³åŒºç§‘æŠ€è·¯100å·;åŒ—äº¬;;100000;ä¸­å›½
NOTE:é‡è¦å®¢æˆ·
BDAY:19900115
END:VCARD
```

### 6.3 è”ç³»äººè¿ç§»æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è”ç³»äººè¿ç§»æ‰§è¡Œæµç¨‹                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. è·å–æºç«¯è”ç³»äººæ–‡ä»¶å¤¹                                     â”‚
â”‚     ewsContactConnector.listContactFolders()                â”‚
â”‚                                                              â”‚
â”‚  2. åˆ†æ‰¹è·å–è”ç³»äºº                                           â”‚
â”‚     for each folder:                                         â”‚
â”‚       â””â”€â”€ ewsContactConnector.listContacts(offset, limit)   â”‚
â”‚                                                              â”‚
â”‚  3. è½¬æ¢ä¸º vCard æ ¼å¼                                        â”‚
â”‚     for each contact:                                        â”‚
â”‚       â”œâ”€â”€ æ£€æŸ¥æ˜¯å¦å·²è¿ç§»ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰                          â”‚
â”‚       â”œâ”€â”€ è·å–è”ç³»äººè¯¦æƒ…                                     â”‚
â”‚       â”‚   ewsContactConnector.getContactDetail(contactId)   â”‚
â”‚       â””â”€â”€ è½¬æ¢ä¸º vCard æ ¼å¼                                  â”‚
â”‚           ContactTransformer.toVCard(contactDetail)         â”‚
â”‚                                                              â”‚
â”‚  4. å†™å…¥ç›®æ ‡ç«¯                                               â”‚
â”‚     cardDavConnector.createContact(vCardData)               â”‚
â”‚                                                              â”‚
â”‚  5. è®°å½•è¿ç§»ç»“æœ                                             â”‚
â”‚     migratedContactRepository.save(record)                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 è”ç³»äººè¿ç§»æ³¨æ„äº‹é¡¹

| é—®é¢˜ | è§£å†³æ–¹æ¡ˆ |
|-----|---------|
| **å¤šé‚®ç®±/å¤šç”µè¯** | ä½¿ç”¨ JSON æ•°ç»„å­˜å‚¨ï¼ŒvCard æ”¯æŒå¤šä¸ª EMAIL/TEL å­—æ®µ |
| **å¤´åƒå›¾ç‰‡** | Base64 ç¼–ç åµŒå…¥ vCard çš„ PHOTO å­—æ®µ |
| **è”ç³»äººåˆ†ç»„** | è¿ç§»æ—¶ä¿ç•™åŸå§‹æ–‡ä»¶å¤¹ç»“æ„æˆ–ä½¿ç”¨ CATEGORIES å­—æ®µ |
| **ç‰¹æ®Šå­—ç¬¦** | vCard éœ€è¦è½¬ä¹‰é€—å·ã€åˆ†å·ç­‰ç‰¹æ®Šå­—ç¬¦ |
| **ç¼–ç é—®é¢˜** | ç»Ÿä¸€ä½¿ç”¨ UTF-8 ç¼–ç  |

---

## ä¸ƒã€API è®¾è®¡

### 7.1 MVP è¿ç§» APIï¼ˆå½“å‰å·²å®ç°ï¼‰

```
åŸºç¡€è·¯å¾„: /api/v1/mvp

POST   /test-connection           æµ‹è¯•è¿æ¥ï¼ˆEWS æˆ– IMAPï¼‰
GET    /check-duplicate           æ£€æŸ¥é‚®ç®±æ˜¯å¦æœ‰æ´»è·ƒä»»åŠ¡
POST   /tasks                     åˆ›å»ºè¿ç§»ä»»åŠ¡
PUT    /tasks/{taskId}            æ›´æ–°è¿ç§»ä»»åŠ¡
GET    /tasks                     è·å–æ‰€æœ‰ä»»åŠ¡
GET    /tasks/{taskId}            è·å–ä»»åŠ¡è¯¦æƒ…
POST   /tasks/{taskId}/start      å¯åŠ¨è¿ç§»
POST   /tasks/{taskId}/pause      æš‚åœè¿ç§»
POST   /tasks/{taskId}/retry      é‡è¯•å¤±è´¥ä»»åŠ¡
DELETE /tasks/{taskId}            åˆ é™¤ä»»åŠ¡
GET    /tasks/{taskId}/folders    è·å–æ–‡ä»¶å¤¹è¿›åº¦
GET    /tasks/{taskId}/folders/{folderName}/emails  è·å–å·²è¿ç§»é‚®ä»¶
GET    /health                    å¥åº·æ£€æŸ¥
```

### 7.2 WebSocket å®æ—¶æ¨é€

```javascript
// å®¢æˆ·ç«¯è®¢é˜…
stompClient.subscribe('/topic/migration/{taskId}/progress', (message) => {
    const progress = JSON.parse(message.body);
    // {
    //     taskId: 123,
    //     status: "RUNNING",
    //     progressPercent: 75,
    //     totalFolders: 10,
    //     migratedFolders: 7,
    //     totalEmails: 1500,
    //     migratedEmails: 1125,
    //     failedEmails: 12,
    //     currentFolder: "å·²å‘é€é‚®ä»¶",
    //     errorMessage: null
    // }
    updateUI(progress);
});
```

### 7.3 è®¡åˆ’ä¸­çš„ APIï¼ˆæ—¥å†å’Œè”ç³»äººï¼‰

```
# æ—¥å†è¿ç§»
GET    /tasks/{taskId}/calendars                è·å–æ—¥å†è¿›åº¦
GET    /tasks/{taskId}/calendars/{name}/events  è·å–å·²è¿ç§»äº‹ä»¶

# è”ç³»äººè¿ç§»
GET    /tasks/{taskId}/contacts                 è·å–è”ç³»äººè¿›åº¦
GET    /tasks/{taskId}/contacts/{folder}        è·å–å·²è¿ç§»è”ç³»äºº
```

---

## å…«ã€å®‰å…¨æ¶æ„

### 8.1 å‡­è¯å®‰å…¨

| æªæ–½ | æè¿° |
|-----|------|
| **å¯†ç åŠ å¯†** | ä½¿ç”¨ Jasypt åŠ å¯†å­˜å‚¨é‚®ç®±å¯†ç  |
| **ä¼ è¾“åŠ å¯†** | TLS/SSL åŠ å¯†æ‰€æœ‰ API é€šä¿¡ |
| **å†…å­˜ä¿æŠ¤** | å¯†ç å¤„ç†ååŠæ—¶æ¸…ç†å†…å­˜ |
| **è®¿é—®æ§åˆ¶** | API é™æµï¼Œé˜²æ­¢æš´åŠ›ç ´è§£ |

### 8.2 æ•°æ®å®‰å…¨

- é‚®ä»¶å†…å®¹ä¸æŒä¹…åŒ–å­˜å‚¨ï¼Œä»…ä½œä¸ºä¼ è¾“ä¸­é—´æ•°æ®
- è¿ç§»å®Œæˆåä»…ä¿ç•™å…ƒæ•°æ®ï¼ˆä¸»é¢˜ã€å‘ä»¶äººç­‰ï¼‰
- æ”¯æŒä»»åŠ¡å®Œæˆåè‡ªåŠ¨æ¸…ç†æ•æ„Ÿæ•°æ®

---

## ä¹ã€è·¯çº¿å›¾

### Phase 1 - MVPï¼ˆå·²å®Œæˆï¼‰
- [x] EWS â†’ IMAP é‚®ä»¶è¿ç§»
- [x] æ–‡ä»¶å¤¹çº§åˆ«è¿›åº¦è·Ÿè¸ª
- [x] æ–­ç‚¹ç»­ä¼ æ”¯æŒ
- [x] å®æ—¶è¿›åº¦æ¨é€ï¼ˆWebSocketï¼‰
- [x] åŸºç¡€ä»»åŠ¡ç®¡ç†ï¼ˆåˆ›å»º/å¯åŠ¨/æš‚åœ/é‡è¯•/åˆ é™¤ï¼‰

### Phase 2 - æ•°æ®å®Œæ•´æ€§ï¼ˆè¿›è¡Œä¸­ï¼‰
- [x] æ—¥å†è¿ç§»è¡¨ç»“æ„è®¾è®¡
- [x] è”ç³»äººè¿ç§»è¡¨ç»“æ„è®¾è®¡
- [ ] EWS æ—¥å†è¯»å–è¿æ¥å™¨
- [ ] EWS è”ç³»äººè¯»å–è¿æ¥å™¨
- [ ] CalDAV æ—¥å†å†™å…¥è¿æ¥å™¨
- [ ] CardDAV è”ç³»äººå†™å…¥è¿æ¥å™¨
- [ ] æ—¥å†/è”ç³»äººè¿ç§»æœåŠ¡

### Phase 3 - åŠŸèƒ½å¢å¼º
- [ ] æ‰¹é‡ç”¨æˆ·è¿ç§»
- [ ] è¿ç§»ä»»åŠ¡æ¨¡æ¿
- [ ] å®šæ—¶è¿ç§»
- [ ] è¿ç§»æŠ¥å‘Šå¯¼å‡º

### Phase 4 - ä¼ä¸šçº§
- [ ] å¤šç§Ÿæˆ·æ”¯æŒ
- [ ] å®¡è®¡æ—¥å¿—
- [ ] ç®¡ç†å‘˜æ§åˆ¶å°
- [ ] SLA ä¿éšœ

---

## åã€æ€»ç»“

MigrateHero å®šä½äºä¼ä¸šæ•°æ®è¿ç§»å¸‚åœºï¼Œå½“å‰ MVP å·²å®ç° EWS â†’ IMAP çš„é‚®ä»¶è¿ç§»åŠŸèƒ½ï¼Œæ”¯æŒï¼š

1. **å®Œæ•´çš„ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ** - åˆ›å»ºã€å¯åŠ¨ã€æš‚åœã€é‡è¯•ã€åˆ é™¤
2. **å®æ—¶è¿›åº¦ç›‘æ§** - WebSocket æ¨é€ï¼Œæ–‡ä»¶å¤¹çº§åˆ«è·Ÿè¸ª
3. **æ–­ç‚¹ç»­ä¼ ** - å¤±è´¥åå¯ä»æ–­ç‚¹ç»§ç»­ï¼Œå·²æˆåŠŸé‚®ä»¶ä¸é‡å¤è¿ç§»
4. **é”™è¯¯è¿½è¸ª** - è®°å½•æ¯å°é‚®ä»¶çš„è¿ç§»çŠ¶æ€å’Œå¤±è´¥åŸå› 

ä¸‹ä¸€é˜¶æ®µå°†æ‰©å±•æ”¯æŒæ—¥å†å’Œè”ç³»äººè¿ç§»ï¼Œå®ç°å®Œæ•´çš„é‚®ç®±æ•°æ®è¿ç§»è§£å†³æ–¹æ¡ˆã€‚
